/*!
 * jquery.linking v0.0.1 (http://alta-novigo.com/jquery-linking)
 * A jQuery plugin to link graphically elements in a simple way
 * Copyright 2015-2015 Alta Novigo
 * License: MIT
 */
!function(a){a.fn.link=function(b){b=b||{};var c={typology:"fully-connected",style:"linear",class_element:"link-element",draggable_element:!1,dyn_clear:!0,box_sizing:"border-box",z_index:"0",cursor:"pointer",link_color:"black",link_width:"2",link_cap:"round",link_join:"round",link_shadow_blur:"0",link_shadow_offset_x:"0",link_shadow_offset_y:"0",link_shadow_color:"black"},d=a.extend(c,b);return this.each(function(){function b(){for(var a=0,b=0,c=0;c<j.length;c++)a+=j[c].x,b+=j[c].y;return 0===j.length?k:{x:a/j.length,y:b/j.length}}function c(){if(j.length>1){d.dyn_clear&&m.clearRect(0,0,l.width(),l.height()),m.beginPath(),m.lineWidth=d.link_width,m.shadowBlur=d.link_shadow_blur,m.shadowOffsetX=d.link_shadow_offset_x,m.shadowOffsetY=d.link_shadow_offset_y,m.shadowColor=d.link_shadow_color,m.strokeStyle=d.link_color,m.lineCap=d.link_cap,m.lineJoin=d.link_join;for(var a=0;a<j.length;a++)for(var c=a+1;c<j.length;c++)if(m.moveTo(j[a].x,j[a].y),"quadratic-isobarycentric"==d.style){var e=b();m.quadraticCurveTo(e.x,e.y,j[c].x,j[c].y)}else m.lineTo(j[c].x,j[c].y);m.stroke()}}function e(){j=[],i.find("."+d.class_element).each(function(){j.push({x:a(this).offset().left+a(this).outerWidth()/2-i.offset().left-i.css("border-left-width").replace("px",""),y:a(this).offset().top+a(this).outerHeight()/2-i.offset().top-i.css("border-top-width").replace("px","")})}),c()}function f(a){a.attr("height",i.height()).attr("width",i.width()).css({position:"absolute",left:0,top:0,overflow:"none",margin:0,padding:0,"z-index":d.z_index}),e()}function g(){d.draggable_element&&(i.find("."+d.class_element).each(function(){a(this).css("position","absolute").css("cursor",d.cursor).draggable({drag:function(b,c){c.position.left<1&&(c.position.left=0),c.position.top<1&&(c.position.top=0),c.position.left>i.width()-a(this).outerWidth()-1&&(c.position.left=i.width()-a(this).outerWidth()),c.position.top>i.height()-a(this).outerHeight()-1&&(c.position.top=i.height()-a(this).outerHeight())}})}),a(document).on("mousedown",function(){n=!0}),a(document).on("mouseup",function(){n=!1}),a(document).on("mousemove",function(){n&&e()}))}function h(a){f(a),g()}var i=a(this),j=[],k={x:0,y:0},l=a("<canvas>Your browser does not support the HTML5 canvas tag.</canvas>").appendTo(this),m=l.get(0).getContext("2d"),n=!1;h(l)})}}(jQuery);